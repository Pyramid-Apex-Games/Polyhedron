//Save, copy, paste and select text combos using common shortcuts.
//By Salatiel
//v: 14/11/2019

_tbhold = 0

textbind = [
	arg3 = (getbind $arg1)
	arg4 = (geteditbind $arg1)
	if (= (strstr (geteditbind $arg1) "_tbhold") -1)[
		if (=s $arg4 "")[arg4 = $arg3]
		bind $arg1 [
			if (= $_tbhold 1)[@@arg2] [@@arg3]
		]
		editbind $arg1 [
			if (= $_tbhold 1)[@@arg2] [@@arg4]
		]
	]
]

//textbind key [action]
textbind a [textselectall]
textbind c [textcopy $textfocus; if (= $textmark 1)[echo "^f7selection copied"][echo "^f7no selection to copy"]]
textbind v [textpaste $textfocus]
textbind s [textsave $textfocus; echo (concat "^f7saved as" $textfocus)]
textbind z [echo $_tbundo]


//use left ctrl as default
bind lctrl [_tbcheckdiff; allowspedit; _tbhold = 1; onrelease [_tbhold = 0;]]
if (= (strstr (geteditbind lctrl) "_tbhold") -1)[
	editbind lctrl (result (concat (geteditbind lctrl) ";" (getbind lctrl)))
]

//"undo" experimental thing
_tbundodiff = ""; _tbundo = ""
_tbcheckdiff = [if (!=s $_tbundodiff $textshow)[_tbundo = $_tbundodiff; _tbundodiff = $textshow]]